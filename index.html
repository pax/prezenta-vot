<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>&#9673;</title>

<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<style>
  body {font-family: sans-serif; margin: 0; padding: 0;}
  #map {width: 100%;   height: 660px;}
  #topControl{
    position: absolute;
    top: 1em;
    left: 1em;
    padding: 1ex;
    font-size: 14px;
    max-width: 7em;
    border:1ex solid White; 

    z-index:2;
    background-color: LightYellow;
  }
  #topControl #layerSwitch label:hover{
    background-color: Yellow;
  }
  #topControl #layerSwitch input + label{
    cursor: pointer;
  }
  #topControl #layerSwitch input:checked + label{
    color: red;
  }
</style>
</head>
<body>
  <div id="topControl">
    <form id="layerSwitch" name="layerSwitch">
      <div><input type="radio" name="xlayers" id="06_10" value="06_10" checked=checked /> <label for="06_10">06.10 @10</label></div>
      <div><input type="radio" name="xlayers" id="06_13" value="06_13" /> <label for="06_13">06.10 @13</label></div>
      <div><input type="radio" name="xlayers" id="06_16" value="06_16" /> <label for="06_16">06.10 @16</label></div>
      <div><input type="radio" name="xlayers" id="06_19" value="06_19" /> <label for="06_19">06.10 @19</label></div>
      <div><input type="radio" name="xlayers" id="06_21" value="06_21" /> <label for="06_21">06.10 @21</label></div>
    </form>
    LP LS UM LT-(LP+LS+UM)

    <div id="controlInfo" ts="06_10">x</div>
    </div>

<div id="map"></div>

<link rel="stylesheet" href="app/assets/vendor/leaflet/leaflet.css" />
  <script src="app/assets/vendor/leaflet/leaflet.js"></script>

  <script src="app/assets/vendor/leaflet/leaflet.ajax.min.js"></script>
  <script src="app/assets/vendor/leaflet/leaflet-providers.js"></script>
  <script src="app/assets/vendor/leaflet/leaflet.label.js"></script>
 
<script>
  var geojsonLayer = new L.GeoJSON.AJAX("data/generated/localitati.json",
  {
    style: layerStyle,
    pointToLayer: function (feature, latlng) { return L.circleMarker(latlng)}
  });

var map = L.map('map', {
      center: [46, 25],
      zoom: 7,
      zoomControl: false, // so we move zoom to the top right corner, see below
      minZoom: 7,
      maxZoom: 10,
      // fullscreenControl: true,
      maxBounds: [[43, 18], [48.7, 30.9]],
      // zoomControl:false ,
      // scrollWheelZoom: false,
      // layers: [romaniaShape, geojsonLayer]
      layers: [geojsonLayer]
    });
new L.Control.Zoom({ position: 'topright' }).addTo(map);
// L.tileLayer.provider('Esri.WorldTopoMap').addTo(map);
L.tileLayer.provider('CartoDB.Positron').addTo(map);

function layerStyle(feature) {

  // var options = document.getElementsByName("xlayers");
  // if (options) {
  //     for (var i = 0; i < options.length; i++) {
  //         if (options[i].checked){
  //              console.log(options[i].value);
  //         }
  //     }
  // }


  // var selectedLayer = 'total';
  // selectedLayer = $("input:radio[name='select_layer']:checked").val();
  selectedLayer=document.getElementById('controlInfo').getAttribute("ts");
  // selectedLayer=typeof document.getElementById('controlInfo').getAttribute("ts") !== 'undefined' ? document.getElementById('controlInfo').getAttribute("ts") : "06_10";
  var xStyle = {weight: 2,fillOpacity: 0.9,stroke: true};
  xStyle.color = "White";
  xStyle.fillColor = "MediumSlateBlue"
  // xStyle.radius = 3;
  // xStyle.radius=Math.round(feature.props.pe_lista/500) + 1;
  // xx=feature.props.ts[selectedLayer];
  // console.log(selectedLayer);
  // console.log(feature.props.ts[selectedLayer].LS);

  xStyle.radius=Math.round(feature.props.ts[selectedLayer].LS/10,0);
// console.log(feature.props.nume_sectie + ' - ' + (Math.round(feature.props.pe_lista / 100) + 1));
// console.log(round(feature.props.pe_lista));

// if (feature=='lala'){
//   xStyle.fillColor = "Red"
// }
// else {xStyle.fillColor = "MediumSlateBlue"}

  // switch (selectedLayer) {
  //   case label1:
  //       code to be executed if n=label1;
  //       break;
  //   case label2:
  //       code to be executed if n=label2;
  //       break;
  //   case label3:
  //       code to be executed if n=label3;
  //       break;
  //   ...
  //   default:
  //       code to be executed if n is different from all labels;
  // }




    // if (selectedLayer == 'vizibil') {
    //   xStyle.radius = feature.props.viz * 1  + 2 ;
    //   if (feature.props.viz != 0)
    //     xStyle.fillColor = "MediumSlateBlue";
    //       else { xStyle.fillColor = "White"; xStyle.color = "Black";  xStyle.radius = 3;} 
    // }
    //   else if (selectedLayer == 'conform')  {
    //     xStyle.radius = feature.props.cf * 1 + 1;
    //     if (feature.props.cf != 0)
    //       xStyle.fillColor = "Green";
    //         else {xStyle.fillColor = "White"; xStyle.color = "Black";   xStyle.radius = 3;}
    //   }
    //     else  if (selectedLayer == 'total') {
    //       xStyle.radius = (feature.props.viz * 1  + feature.props.cf * 1);
    //       xStyle.fillColor = "Orange";
    //       if (xStyle.radius == 0) {
    //         xStyle.fillColor = "White"; xStyle.color = "Black";   xStyle.radius = 3;
    //       }
    //     }
// console.log('lala');
return xStyle;
}


// Add custom popups to each using our custom feature properties
geojsonLayer.on("layeradd", function(e) {
  var marker = e.layer,
    feature = marker.feature;

  // Create custom popup content
    var out = "<h4>" +  feature.props.nume_sectie  + "</h4>";
    out +=   "<b>" +  feature.props.localitate + "</b><br>Înscriși pe lista: <b>" + feature.props.pe_lista + "</b>";
    // out += JSON.stringify(feature.props.ts, null, 2)
    var popupContent = out;

  // http://leafletjs.com/reference.html#popup
  marker.bindPopup(popupContent,{
    closeButton: true,
    minWidth: 200
  });
});

  //  read select
  var rad = document.layerSwitch.xlayers;
  for(var i = 0; i < rad.length; i++) {
      rad[i].onclick = function() {
        let selectedLayer=this.value;
        geojsonLayer.setStyle(layerStyle);
        document.getElementById('controlInfo').innerHTML=this.value;
        document.getElementById('controlInfo').setAttribute("ts", this.value);
      };
  }

</script>
 

 </body>
</html>
 